<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <script>
        function countWords(str) {
            return str.trim().split(/\s+/).length;
        }

        function validateBio() {
            const bioField = document.getElementById('bio');
            const bioWarning = document.getElementById('bio-warning');
            const maxWords = 200;
            const wordCount = countWords(bioField.value);
            
            if (wordCount > maxWords) {
                bioWarning.style.display = 'block';
                bioWarning.textContent = `Bio exceeds ${maxWords} words. Current word count: ${wordCount}`;
                return false;
            } else {
                bioWarning.style.display = 'none';
                return true;
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            const bioField = document.getElementById('bio');
            bioField.addEventListener('input', validateBio);
        });
    </script>
</head>
<body>
    <h1>Profile</h1>
    <form action="{{ url_for('auth.update_profile') }}" method="post">
        <div>
            <label for="first_name">First Name:</label>
            <input type="text" name="first_name" id="first_name" value="{{ current_user.first_name }}">
        </div>
        <div>
            <label for="last_name">Last Name:</label>
            <input type="text" name="last_name" id="last_name" value="{{ current_user.last_name }}">
        </div>
        <div>
            <label for="phone_number">Phone Number:</label>
            <input type="text" name="phone_number" id="phone_number" value="{{ current_user.phone_number }}">
        </div>
        <div>
            <label for="location">Location:</label>
            <input type="text" name="location" id="location" value="{{ current_user.location }}">
        </div>
        <div>
            <label for="institution">Institution/Organization Name:</label>
            <input type="text" name="institution" id="institution" value="{{ current_user.institution }}">
        </div>
        <div>
            <label for="role">Your Role:</label>
            <input type="text" name="role" id="role" value="{{ current_user.role }}">
        </div>
        <div>
            <label for="address_line1">Address Line 1:</label>
            <input type="text" name="address_line1" id="address_line1" value="{{ current_user.address_line1 }}">
        </div>
        <div>
            <label for="address_line2">Address Line 2:</label>
            <input type="text" name="address_line2" id="address_line2" value="{{ current_user.address_line2 }}">
        </div>
        <div>
            <label for="zip_code">Zip Code:</label>
            <input type="text" name="zip_code" id="zip_code" value="{{ current_user.zip_code }}">
        </div>
          <div>
            <label for="bio">Bio:</label>
            <textarea name="bio" id="bio" rows="4">{{ current_user.bio }}</textarea>
            <p id="bio-warning" style="color: red; display: none;"></p>
        </div>
        <div>
            <label for="avatar">Avatar:</label>
            <input type="file" name="avatar" id="avatar">
            {% if current_user.avatar %}
                <img src="{{ url_for('static', filename='uploads/' + current_user.avatar) }}" alt="Avatar" width="100">
            {% endif %}
        </div>
        <div>
            <label for="coverphoto">Cover Photo:</label>
            <input type="file" name="coverphoto" id="coverphoto">
            {% if current_user.coverphoto %}
                <img src="{{ url_for('static', filename='uploads/' + current_user.coverphoto) }}" alt="Cover Photo" width="200">
            {% endif %}
        </div>
        <div>
            <button type="submit">Update Profile</button>
        </div>
    </form>
    </form>
</body>
</html>
